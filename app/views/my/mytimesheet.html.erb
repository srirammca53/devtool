<html>
<body>
<center>
Time sheet
</center>
<hr/>
<p>From <%= @start %> to <%= @end %></p>
<% @total_time = 0 %>
<table width=100%>
	<tr>
		<th width=10%>Date</th>
		<th  width=10%>Project</th>
		<th  width=10%>Iteration</th>
		<th  width=10%>Story</th>
		<th  width=10%>Task</th>
		<th  width=10%>Estimated</th>
		<th width=10%>Spent Hours</th>
		<th width=30%>Description</th>
	</tr>
	<% @tasks = Task.find(:all,:conditions=>{:acceptor=>@user}) %>
		<% @tasks.each do |t| %>
		<% @stories = Story.find(:all,:conditions=>{:id=>t.story_id}) %>
			<% @stories.each do |st| %>
               		 <% @iterations = Iteration.find(:all,:conditions=>{:id=>st.iteration_id}) %>
				 <% @iterations.each do |it| %>
				 <% @projects = Project.find(:all,:conditions=>{:id=>it.project_id}) %>
					 <% @projects.each do |pt| %>
						<% t.logs.each do|log| %>
						  <% @total_time = @total_time + log.spent_hours %>
							<tr>
								<td width=10% align=center><%= log.report_date %></td>
								<td  width=10% align=center><%= pt.name %></td>
								<td  width=10% align=center><%= it.name %></td>
								<td  width=10% align=center><%= st.name %></td>
								<td  width=10% align=center><%= t.name %></td>
								<td  width=10% align=center><%= t.estimated_hours %></td>
								<td width=10% align=center><%= log.spent_hours %> </td>
								<td width=30% align= center><%= log.description %></td>
							</tr>
						<% end %>
					<% end %>
				<% end %>
			<% end %>
		<% end %>
</table>
<hr/>
<b>Total Spent Hours </b> :	<%= @total_time %>
</body>
</html>
